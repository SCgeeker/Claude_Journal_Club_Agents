# RelationFinder æ”¹é€²æ–¹æ¡ˆå¯¦æ–½æª¢æŸ¥æ¸…å–®

**æ–‡ä»¶ç‰ˆæœ¬**: 1.0
**å‰µå»ºæ—¥æœŸ**: 2025-11-06
**é è¨ˆå®Œæˆæ™‚é–“**: 6-9 å¤©
**è² è²¬äºº**: [å¾…å¡«]

---

## ğŸ“‹ ç¸½è¦½

| Phase | å„ªå…ˆç´š | é è¨ˆæ™‚é–“ | ç‹€æ…‹ |
|-------|--------|----------|------|
| **Phase 1**: æ ¸å¿ƒæ”¹é€² | P0 | 1-2å¤© | â¬œ å¾…é–‹å§‹ |
| **Phase 2**: é€£çµå¢å¼· | P1 | 2-3å¤© | â¬œ å¾…é–‹å§‹ |
| **Phase 3**: æ°¸ä¹…ç­†è¨˜ | P2 | 3-4å¤© | â¬œ å¾…é–‹å§‹ |
| **æ¸¬è©¦èˆ‡é©—è­‰** | - | æŒçºŒ | â¬œ å¾…é–‹å§‹ |
| **æ–‡æª”æ›´æ–°** | - | 1å¤© | â¬œ å¾…é–‹å§‹ |

---

## Phase 1: æ ¸å¿ƒæ”¹é€²ï¼ˆP0å„ªå…ˆç´šï¼Œ1-2å¤©ï¼‰

### ä»»å‹™ 1.1: æ“´å±•å…±åŒæ¦‚å¿µæå–

**ç›®æ¨™**: å¾ 5 å€‹ä¾†æºæå–æ¦‚å¿µï¼Œå¯¦ä½œåŠ æ¬Šè©•åˆ†

**å­ä»»å‹™**:

- [ ] **1.1.1** å¯¦ä½œ `_extract_concepts_enhanced(card)` å‡½æ•¸
  - [ ] æå– tagsï¼ˆæ¬Šé‡ 1.0ï¼‰
  - [ ] æå– core_conceptï¼ˆæ¬Šé‡ 0.9ï¼‰
  - [ ] æå– **description**ï¼ˆæ¬Šé‡ 0.8ï¼‰- æ–°å¢ï¼
  - [ ] æå– titleï¼ˆæ¬Šé‡ 0.7ï¼‰
  - [ ] æå– ai_notes å°ˆæœ‰åè©ï¼ˆæ¬Šé‡ 0.6ï¼‰
  - [ ] è¿”å› `(concepts: Set[str], sources: Dict)`

- [ ] **1.1.2** å¯¦ä½œä¸­æ–‡åˆ†è©å‡½æ•¸
  - [ ] **æ–¹æ¡ˆ Aï¼ˆå„ªå…ˆï¼‰**: å¯¦ä½œé å®šç¾©è©åº«ç‰ˆæœ¬
    - [ ] å®šç¾©èªçŸ¥ç§‘å­¸è©å½™ï¼ˆ50-100å€‹ï¼‰
    - [ ] å®šç¾©èªè¨€å­¸è©å½™ï¼ˆ50-100å€‹ï¼‰
    - [ ] å®šç¾© AI è©å½™ï¼ˆ50-100å€‹ï¼‰
    - [ ] å®šç¾©æ–¹æ³•è«–è©å½™ï¼ˆ30-50å€‹ï¼‰
  - [ ] **æ–¹æ¡ˆ Bï¼ˆå¯é¸ï¼‰**: jieba åˆ†è©æ”¯æ´
    - [ ] æª¢æ¸¬ jieba æ˜¯å¦å®‰è£
    - [ ] å¯¦ä½œ TF-IDF é—œéµè©æå–
    - [ ] Fallback åˆ°æ–¹æ¡ˆ A

- [ ] **1.1.3** å¯¦ä½œ `_extract_shared_concepts_enhanced(card1, card2)`
  - [ ] èª¿ç”¨ `_extract_concepts_enhanced()` å…©æ¬¡
  - [ ] è¨ˆç®—äº¤é›†
  - [ ] è¨˜éŒ„æ¯å€‹å…±åŒæ¦‚å¿µçš„ä¾†æº
  - [ ] è¨ˆç®—åŠ æ¬Šå…±åŒæ¦‚å¿µåˆ†æ•¸
  - [ ] è¿”å› `(shared: List[str], details: Dict)`

- [ ] **1.1.4** æ›´æ–° `_calculate_confidence()` å‡½æ•¸
  - [ ] æ›¿æ› `_extract_shared_concepts_from_cards()` èª¿ç”¨
  - [ ] ä½¿ç”¨åŠ æ¬Šåˆ†æ•¸è¨ˆç®— co_occurrence ç¶­åº¦
  - [ ] èª¿æ•´æ­£è¦åŒ–é–¾å€¼ï¼ˆ5 â†’ 10ï¼‰

**æ–‡ä»¶ä½ç½®**: `src/analyzers/relation_finder.py:697-752`

**æ¸¬è©¦**:
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_extract_concepts_enhanced()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_chinese_segmentation()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_extract_shared_concepts_enhanced()`

**é©—æ”¶æ¨™æº–**:
- [ ] å…±åŒæ¦‚å¿µæ•¸é‡å¹³å‡å¢åŠ  50%+
- [ ] description æ¬„ä½è¢«æ­£ç¢ºä½¿ç”¨
- [ ] å–®å…ƒæ¸¬è©¦é€šéç‡ 100%

---

### ä»»å‹™ 1.2: é ˜åŸŸç›¸é—œæ€§çŸ©é™£

**ç›®æ¨™**: å¯¦ä½œé ˜åŸŸç›¸é—œæ€§çŸ©é™£ï¼Œæ”¯æ´å¤šé ˜åŸŸ

**å­ä»»å‹™**:

- [ ] **1.2.1** å®šç¾©é ˜åŸŸç›¸é—œæ€§çŸ©é™£
  - [ ] åœ¨ `__init__()` ä¸­å®šç¾© `self.domain_similarity_matrix`
  - [ ] é«˜åº¦ç›¸é—œï¼šCogSci â†” AI (0.8)
  - [ ] é«˜åº¦ç›¸é—œï¼šCogSci â†” Linguistics (0.8)
  - [ ] ä¸­åº¦ç›¸é—œï¼šAI â†” Linguistics (0.6)
  - [ ] é»˜èªå€¼ï¼š0.3

- [ ] **1.2.2** å¯¦ä½œ `_get_domain_similarity(domain1, domain2)`
  - [ ] æŸ¥æ‰¾é å®šç¾©çŸ©é™£
  - [ ] è™•ç†ç¼ºå¤±é ˜åŸŸï¼ˆè¿”å› 0.3ï¼‰
  - [ ] æ¨¡ç³ŠåŒ¹é…ï¼ˆ"Cognitive Neuroscience" â†’ "CogSci"ï¼‰
  - [ ] å°ç¨±æ€§ä¿è­‰ï¼ˆd1â†”d2 = d2â†”d1ï¼‰

- [ ] **1.2.3** å¯¦ä½œ `_parse_domain(domain_str)`
  - [ ] æ”¯æ´å–®é ˜åŸŸï¼š"CogSci"
  - [ ] æ”¯æ´å¤šé ˜åŸŸï¼š"CogSci, AI"
  - [ ] æ”¯æ´è±ç·šåˆ†éš”ï¼š"CogSci|AI"
  - [ ] è¿”å› `List[str]`

- [ ] **1.2.4** å¯¦ä½œ `_calculate_multi_domain_similarity(domains1, domains2)`
  - [ ] è¨ˆç®—æ‰€æœ‰é ˜åŸŸå°çš„ç›¸ä¼¼åº¦
  - [ ] è¿”å›æœ€å¤§å€¼ï¼ˆå–æœ€ç›¸é—œçš„çµ„åˆï¼‰
  - [ ] è™•ç†ç©ºåˆ—è¡¨æƒ…æ³

- [ ] **1.2.5** æ›´æ–° `_calculate_confidence()` å‡½æ•¸
  - [ ] æ›¿æ›é ˜åŸŸä¸€è‡´æ€§è¨ˆç®—é‚è¼¯
  - [ ] ä½¿ç”¨ `_calculate_multi_domain_similarity()`
  - [ ] ä¹˜ä»¥æ¬Šé‡ 0.1

**æ–‡ä»¶ä½ç½®**: `src/analyzers/relation_finder.py:625-672`

**æ¸¬è©¦**:
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_domain_similarity()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_parse_domain()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_multi_domain_similarity()`

**é©—æ”¶æ¨™æº–**:
- [ ] è·¨é ˜åŸŸå¡ç‰‡ä¿¡åº¦æå‡ 20%+
- [ ] å¤šé ˜åŸŸæ ¼å¼è¢«æ­£ç¢ºè§£æ
- [ ] å–®å…ƒæ¸¬è©¦é€šéç‡ 100%

---

### ä»»å‹™ 1.3: é…ç½®æ–‡ä»¶æ›´æ–°

**å­ä»»å‹™**:

- [ ] **1.3.1** æ›´æ–° `config/settings.yaml`
  - [ ] æ–°å¢ `relation_finder` å€å¡Š
  - [ ] å®šç¾© `confidence_weights`
  - [ ] å®šç¾© `concept_source_weights`
  - [ ] å®šç¾© `domain_similarity` çŸ©é™£
  - [ ] å®šç¾© `chinese_segmentation` é…ç½®

- [ ] **1.3.2** å¯¦ä½œé…ç½®è¼‰å…¥é‚è¼¯
  - [ ] åœ¨ `RelationFinder.__init__()` è®€å–é…ç½®
  - [ ] æä¾›é»˜èªå€¼
  - [ ] é©—è­‰é…ç½®æ ¼å¼

**æ–‡ä»¶ä½ç½®**: `config/settings.yaml`

**é©—æ”¶æ¨™æº–**:
- [ ] é…ç½®æ–‡ä»¶ç¬¦åˆ YAML æ ¼å¼
- [ ] æ‰€æœ‰æ¬Šé‡ç¸½å’Œç‚º 1.0
- [ ] é…ç½®è¼‰å…¥ç„¡éŒ¯èª¤

---

### ä»»å‹™ 1.4: å–®å…ƒæ¸¬è©¦ï¼ˆPhase 1ï¼‰

**æ–‡ä»¶ä½ç½®**: `tests/test_relation_finder_phase1.py`

**æ¸¬è©¦æ¡ˆä¾‹**:

- [ ] **æ¸¬è©¦ 1**: å…±åŒæ¦‚å¿µæå–
  ```python
  def test_enhanced_concept_extraction():
      # æº–å‚™æ¸¬è©¦å¡ç‰‡
      card1 = {
          'tags': '["è¦–è¦º", "æ³¨æ„"]',
          'core_concept': 'Visual attention mechanisms',
          'description': 'è¦–è¦ºæ³¨æ„æ˜¯èªçŸ¥ç§‘å­¸ä¸­çš„æ ¸å¿ƒæ¦‚å¿µ',
          'title': 'è¦–è¦ºæ³¨æ„æ©Ÿåˆ¶æ¦‚è¿°'
      }
      # é©—è­‰å…±åŒæ¦‚å¿µæ•¸é‡
      # é©—è­‰ä¾†æºè¨˜éŒ„
  ```

- [ ] **æ¸¬è©¦ 2**: é ˜åŸŸç›¸é—œæ€§
  ```python
  def test_domain_similarity():
      # æ¸¬è©¦åŒé ˜åŸŸ
      # æ¸¬è©¦é«˜åº¦ç›¸é—œ
      # æ¸¬è©¦ä¸­åº¦ç›¸é—œ
      # æ¸¬è©¦å¼±ç›¸é—œ
  ```

- [ ] **æ¸¬è©¦ 3**: å¤šé ˜åŸŸæ”¯æ´
  ```python
  def test_multi_domain_support():
      # æ¸¬è©¦å¤šé ˜åŸŸè§£æ
      # æ¸¬è©¦å¤šé ˜åŸŸç›¸ä¼¼åº¦è¨ˆç®—
  ```

- [ ] **æ¸¬è©¦ 4**: ä¸­æ–‡åˆ†è©
  ```python
  def test_chinese_segmentation():
      # æ¸¬è©¦é å®šç¾©è©åº«
      # æ¸¬è©¦ jiebaï¼ˆå¦‚æœå®‰è£ï¼‰
  ```

**é©—æ”¶æ¨™æº–**:
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] ä»£ç¢¼è¦†è“‹ç‡ > 80%
- [ ] ç„¡è­¦å‘Šæˆ–éŒ¯èª¤

---

### ä»»å‹™ 1.5: Phase 1 æ•´åˆæ¸¬è©¦

**å­ä»»å‹™**:

- [ ] **1.5.1** åŸ·è¡Œå®Œæ•´çš„é—œä¿‚è­˜åˆ¥
  ```bash
  python -c "
  from src.analyzers.relation_finder import RelationFinder
  finder = RelationFinder()
  relations = finder.find_concept_relations(min_similarity=0.3)
  print(f'é—œä¿‚ç¸½æ•¸: {len(relations)}')
  "
  ```

- [ ] **1.5.2** æª¢æŸ¥ä¿¡åº¦è©•åˆ†åˆ†å¸ƒ
  - [ ] çµ±è¨ˆå„ä¿¡åº¦å€é–“çš„é—œä¿‚æ•¸é‡
  - [ ] é©—è­‰æ˜¯å¦æœ‰ â‰¥ 0.4 çš„é—œä¿‚

- [ ] **1.5.3** äººå·¥æŠ½æŸ¥
  - [ ] éš¨æ©ŸæŠ½å– 10 æ¢é«˜ä¿¡åº¦é—œä¿‚
  - [ ] é©—è­‰å…±åŒæ¦‚å¿µæ˜¯å¦åˆç†
  - [ ] é©—è­‰é ˜åŸŸç›¸ä¼¼åº¦æ˜¯å¦æ­£ç¢º

**é©—æ”¶æ¨™æº–**:
- [ ] é«˜ä¿¡åº¦é—œä¿‚æ•¸ï¼ˆâ‰¥ 0.4ï¼‰> 0ï¼ˆè§£æ±ºåŸºæº–æ¸¬è©¦å•é¡Œï¼‰
- [ ] å¹³å‡ä¿¡åº¦æå‡è‡³ 0.40+
- [ ] ç„¡å›æ­¸éŒ¯èª¤ï¼ˆåŸæœ‰åŠŸèƒ½æ­£å¸¸ï¼‰

---

## Phase 2: é€£çµå¢å¼·ï¼ˆP1å„ªå…ˆç´šï¼Œ2-3å¤©ï¼‰

### ä»»å‹™ 2.1: å¤šå±¤æ¬¡æ˜ç¢ºé€£çµæª¢æ¸¬

**ç›®æ¨™**: å¯¦ä½œ 4 å±¤é€£çµæª¢æ¸¬ï¼Œè¨ˆç®—é€£çµå¼·åº¦

**å­ä»»å‹™**:

- [ ] **2.1.1** å¯¦ä½œ `_extract_section(content, section_title)`
  - [ ] ä½¿ç”¨æ­£å‰‡è¡¨é”å¼æå– Markdown å€å¡Š
  - [ ] æ”¯æ´ `## é€£çµç¶²çµ¡`
  - [ ] æ”¯æ´ `## ä¾†æºè„ˆçµ¡`
  - [ ] è™•ç†ç©ºç™½å’Œæ ¼å¼å•é¡Œ

- [ ] **2.1.2** å¯¦ä½œ `_extract_link_context(text, target_id, window=50)`
  - [ ] æ‰¾åˆ° `[[target_id]]` ä½ç½®
  - [ ] æå–å‰å¾Œå„ 50 å€‹å­—ç¬¦
  - [ ] è¿”å›ä¸Šä¸‹æ–‡å­—ç¬¦ä¸²

- [ ] **2.1.3** å¯¦ä½œ `_get_card_title(zettel_id)`
  - [ ] å¾è³‡æ–™åº«æŸ¥è©¢æ¨™é¡Œ
  - [ ] å¯¦ä½œå¿«å–æ©Ÿåˆ¶ï¼ˆé¿å…é‡è¤‡æŸ¥è©¢ï¼‰
  - [ ] è™•ç†ä¸å­˜åœ¨çš„ ID

- [ ] **2.1.4** å¯¦ä½œ `_check_explicit_link_enhanced(card, target_id)`
  - [ ] **å±¤æ¬¡ 1**: AIç­†è¨˜ä¸­çš„ Wiki Links
    - [ ] æª¢æŸ¥ `[[target_id]]` å­˜åœ¨
    - [ ] æå–é€£çµèªå¢ƒ
    - [ ] è­˜åˆ¥é—œä¿‚é—œéµè©ï¼ˆåŸºæ–¼/å°å‘/å°æ¯”ï¼‰
    - [ ] è©•åˆ†ï¼š0.5-1.0
  - [ ] **å±¤æ¬¡ 2**: é€£çµç¶²çµ¡å€å¡Š
    - [ ] æå– `## é€£çµç¶²çµ¡` å€å¡Š
    - [ ] æª¢æŸ¥ target_id æ˜¯å¦å‡ºç¾
    - [ ] è­˜åˆ¥é€£çµé¡å‹æ¨™è¨»
    - [ ] è©•åˆ†ï¼š0.6-0.8
  - [ ] **å±¤æ¬¡ 3**: ä¾†æºè„ˆçµ¡æåŠ
    - [ ] æå– `## ä¾†æºè„ˆçµ¡` å€å¡Š
    - [ ] æª¢æŸ¥ target_id æ˜¯å¦å‡ºç¾
    - [ ] è©•åˆ†ï¼š0.4
  - [ ] **å±¤æ¬¡ 4**: å…§å®¹è‡ªç„¶æåŠ
    - [ ] ç²å– target å¡ç‰‡æ¨™é¡Œ
    - [ ] æª¢æŸ¥æ¨™é¡Œæ˜¯å¦åœ¨ content ä¸­
    - [ ] è©•åˆ†ï¼š0.3
  - [ ] è¿”å› `(has_link: bool, link_strength: float)`

- [ ] **2.1.5** æ›´æ–° `_calculate_confidence()` å‡½æ•¸
  - [ ] æ›¿æ› `_check_explicit_link()` èª¿ç”¨
  - [ ] ä½¿ç”¨é€£çµå¼·åº¦è€ŒéäºŒå…ƒå€¼
  - [ ] `scores['link_explicit'] = 0.3 * link_strength`

**æ–‡ä»¶ä½ç½®**: `src/analyzers/relation_finder.py:674-695`

**æ¸¬è©¦**:
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_extract_section()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_extract_link_context()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_multi_layer_link_detection()`

**é©—æ”¶æ¨™æº–**:
- [ ] é€£çµèªå¢ƒè­˜åˆ¥æº–ç¢ºç‡ > 80%
- [ ] æ˜ç¢ºé€£çµè²¢ç»å¾ 0.035 æå‡è‡³ 0.10+
- [ ] å–®å…ƒæ¸¬è©¦é€šéç‡ 100%

---

### ä»»å‹™ 2.2: æ”¹é€² Zettelkasten Prompt

**ç›®æ¨™**: æ›´æ–° Promptï¼Œè¦æ±‚ LLM ç”Ÿæˆå¡ç‰‡é–“é€£çµ

**å­ä»»å‹™**:

- [ ] **2.2.1** æ›´æ–° `templates/prompts/zettelkasten_template.jinja2`
  - [ ] æ–°å¢ AI ç­†è¨˜ç”ŸæˆæŒ‡å¼•å€å¡Š
  - [ ] æ˜ç¢ºè¦æ±‚ã€Œå¿…é ˆå»ºç«‹ 2-3 å€‹å¡ç‰‡é€£çµã€
  - [ ] èªªæ˜é€£çµæ ¼å¼ï¼š`[[zettel_id]]`
  - [ ] èªªæ˜é€£çµèªå¢ƒï¼šã€ŒåŸºæ–¼ã€ã€ã€Œå°å‘ã€ã€ã€Œå°æ¯”ã€

- [ ] **2.2.2** æ–°å¢ Few-shot ç¯„ä¾‹
  - [ ] ç¯„ä¾‹ 1ï¼šåŸºæ–¼é€£çµ
    ```markdown
    **[AI Agent]**:
    æ­¤æ¦‚å¿µ**åŸºæ–¼** [[CogSci-001]] ä¸­çš„ã€Œå…§éš±å­¸ç¿’ã€ç†è«–...
    ```
  - [ ] ç¯„ä¾‹ 2ï¼šå°æ¯”é€£çµ
    ```markdown
    **[AI Agent]**:
    é€™å€‹ç™¼ç¾**å°æ¯”**æ–¼ [[CogSci-005]] çš„è§€é»...
    ```
  - [ ] ç¯„ä¾‹ 3ï¼šå°å‘é€£çµ
    ```markdown
    **[AI Agent]**:
    é€²ä¸€æ­¥**å°å‘** [[CogSci-010]] è¨è«–çš„æ‡‰ç”¨...
    ```

- [ ] **2.2.3** æ›´æ–°ç³»çµ±æç¤º
  - [ ] å¼·èª¿é€£çµçš„é‡è¦æ€§
  - [ ] è¦æ±‚æ‰¹åˆ¤æ€§æ€è€ƒèˆ‡é€£çµå»ºç«‹ä¸¦é‡
  - [ ] æä¾›é€£çµå¤±æ•—çš„ fallback èªªæ˜

**æ–‡ä»¶ä½ç½®**: `templates/prompts/zettelkasten_template.jinja2`

**æ¸¬è©¦**:
- [ ] ç”Ÿæˆ 5 å¼µæ¸¬è©¦å¡ç‰‡
- [ ] æª¢æŸ¥ AI notes æ˜¯å¦åŒ…å«é€£çµ
- [ ] çµ±è¨ˆå¹³å‡é€£çµæ•¸

**é©—æ”¶æ¨™æº–**:
- [ ] AI notes å¹³å‡åŒ…å« 2-3 å€‹é€£çµ
- [ ] é€£çµæ ¼å¼æ­£ç¢ºï¼ˆ`[[zettel_id]]`ï¼‰
- [ ] é€£çµæœ‰èªå¢ƒï¼ˆéå­¤ç«‹ï¼‰

---

### ä»»å‹™ 2.3: æ¸¬è©¦æ–° Prompt æ•ˆæœ

**å­ä»»å‹™**:

- [ ] **2.3.1** é¸æ“‡æ¸¬è©¦è«–æ–‡
  - [ ] é¸æ“‡ 1-2 ç¯‡æ–°è«–æ–‡
  - [ ] æˆ–é‡æ–°ç”Ÿæˆç¾æœ‰è«–æ–‡çš„ Zettelkasten

- [ ] **2.3.2** åŸ·è¡Œ Zettelkasten ç”Ÿæˆ
  ```bash
  python -c "
  from src.generators.zettel_maker import ZettelMaker
  maker = ZettelMaker()
  result = maker.generate_zettelkasten(
      pdf_path='test_paper.pdf',
      domain='CogSci',
      card_count=20
  )
  "
  ```

- [ ] **2.3.3** åˆ†æç”Ÿæˆçµæœ
  - [ ] çµ±è¨ˆæ˜ç¢ºé€£çµæ•¸é‡
  - [ ] æª¢æŸ¥é€£çµèªå¢ƒè³ªé‡
  - [ ] é©—è­‰é€£çµç›®æ¨™æ˜¯å¦å­˜åœ¨

- [ ] **2.3.4** è¨ˆç®—è¦†è“‹ç‡æå‡
  - [ ] æ˜ç¢ºé€£çµè¦†è“‹ç‡ï¼š11.6% â†’ ?
  - [ ] ç›®æ¨™ï¼š> 30%

**é©—æ”¶æ¨™æº–**:
- [ ] æ˜ç¢ºé€£çµè¦†è“‹ç‡ > 30%
- [ ] é€£çµè³ªé‡äººå·¥è©•ä¼° > 70% åˆç†
- [ ] ç„¡æ ¼å¼éŒ¯èª¤

---

### ä»»å‹™ 2.4: Phase 2 æ•´åˆæ¸¬è©¦

**å­ä»»å‹™**:

- [ ] **2.4.1** é‡æ–°åŸ·è¡Œé—œä¿‚è­˜åˆ¥
  ```bash
  python kb_manage.py build-concept-network
  ```

- [ ] **2.4.2** ç”Ÿæˆæ–°çš„åˆ†æå ±å‘Š
  ```bash
  python kb_manage.py visualize-network --obsidian \
      --output output/concept_analysis_v2
  ```

- [ ] **2.4.3** æ¯”è¼ƒ v1 vs v2
  - [ ] é«˜ä¿¡åº¦é—œä¿‚æ•¸
  - [ ] å¹³å‡ä¿¡åº¦
  - [ ] å»ºè­°é€£çµæ•¸é‡
  - [ ] ç¶²çµ¡å¯†åº¦

- [ ] **2.4.4** äººå·¥é©—è­‰
  - [ ] éš¨æ©ŸæŠ½å– 20 æ¢é«˜ä¿¡åº¦é—œä¿‚
  - [ ] è©•ä¼°æº–ç¢ºç‡
  - [ ] ç›®æ¨™ï¼š> 80%

**é©—æ”¶æ¨™æº–**:
- [ ] é«˜ä¿¡åº¦é—œä¿‚æ•¸é¡¯è‘—å¢åŠ 
- [ ] Obsidian å»ºè­°é€£çµæ–‡ä»¶éç©º
- [ ] æº–ç¢ºç‡ > 80%

---

## Phase 3: æ°¸ä¹…ç­†è¨˜ç”Ÿæˆå™¨ï¼ˆP2å„ªå…ˆç´šï¼Œ3-4å¤©ï¼‰

### ä»»å‹™ 3.1: PermanentNoteGenerator é¡

**ç›®æ¨™**: å¯¦ä½œæ°¸ä¹…ç­†è¨˜ç”Ÿæˆæ ¸å¿ƒé¡

**å­ä»»å‹™**:

- [ ] **3.1.1** å‰µå»ºæ–‡ä»¶çµæ§‹
  - [ ] å‰µå»º `src/analyzers/permanent_note_generator.py`
  - [ ] å®šç¾© `PermanentNoteGenerator` é¡

- [ ] **3.1.2** å¯¦ä½œ `__init__(kb_path)`
  - [ ] åˆå§‹åŒ–çŸ¥è­˜åº«è·¯å¾‘
  - [ ] é€£æ¥è³‡æ–™åº«
  - [ ] åˆå§‹åŒ– LLM å®¢æˆ¶ç«¯

- [ ] **3.1.3** å¯¦ä½œ `_fetch_card(zettel_id)`
  - [ ] å¾è³‡æ–™åº«æŸ¥è©¢å¡ç‰‡
  - [ ] è¿”å›å®Œæ•´å¡ç‰‡æ•¸æ“š

- [ ] **3.1.4** å¯¦ä½œ `_build_synthesis_prompt(topic, notes_collection)`
  - [ ] æ§‹å»ºä¸»é¡Œèªªæ˜
  - [ ] åˆ—å‡ºæ‰€æœ‰è¼¸å…¥å¡ç‰‡
  - [ ] åŒ…å« AI notes å’Œ Human notes
  - [ ] å®šç¾©è¼¸å‡ºæ ¼å¼è¦æ±‚
  - [ ] è¿”å›å®Œæ•´ Prompt

- [ ] **3.1.5** å¯¦ä½œ `_call_llm(prompt)`
  - [ ] èª¿ç”¨ LLM API
  - [ ] è™•ç†éŒ¯èª¤å’Œé‡è©¦
  - [ ] è¿”å›ç”Ÿæˆå…§å®¹

- [ ] **3.1.6** å¯¦ä½œ `_format_permanent_note(topic, content, source_zettel)`
  - [ ] æ·»åŠ æ¨™é¡Œå’Œå…ƒæ•¸æ“š
  - [ ] æ ¼å¼åŒ–ä¾†æºå¡ç‰‡å¼•ç”¨
  - [ ] æ·»åŠ ç”Ÿæˆæ™‚é–“æˆ³
  - [ ] è¿”å›å®Œæ•´ Markdown

- [ ] **3.1.7** å¯¦ä½œ `generate_permanent_note(topic, related_zettel_ids, output_path)`
  - [ ] æ”¶é›†ç›¸é—œå¡ç‰‡
  - [ ] æ§‹å»º Prompt
  - [ ] èª¿ç”¨ LLM
  - [ ] æ ¼å¼åŒ–è¼¸å‡º
  - [ ] å„²å­˜æ–‡ä»¶
  - [ ] è¿”å›ç”Ÿæˆå…§å®¹

**æ–‡ä»¶ä½ç½®**: `src/analyzers/permanent_note_generator.py`

**æ¸¬è©¦**:
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_fetch_card()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_build_synthesis_prompt()`
- [ ] å–®å…ƒæ¸¬è©¦ï¼š`test_format_permanent_note()`

**é©—æ”¶æ¨™æº–**:
- [ ] é¡çµæ§‹æ¸…æ™°
- [ ] æ‰€æœ‰æ–¹æ³•å¯¦ä½œå®Œæˆ
- [ ] å–®å…ƒæ¸¬è©¦é€šéç‡ 100%

---

### ä»»å‹™ 3.2: CLI æ•´åˆ

**ç›®æ¨™**: æ•´åˆåˆ° `kb_manage.py`

**å­ä»»å‹™**:

- [ ] **3.2.1** æ–°å¢ `synthesize-permanent-note` å‘½ä»¤
  ```python
  @cli.command('synthesize-permanent-note')
  @click.option('--topic', required=True)
  @click.option('--zettel-ids', required=True, multiple=True)
  @click.option('--output')
  def synthesize_permanent_note(topic, zettel_ids, output):
      # èª¿ç”¨ PermanentNoteGenerator
      pass
  ```

- [ ] **3.2.2** å¯¦ä½œå‘½ä»¤è™•ç†é‚è¼¯
  - [ ] è§£æåƒæ•¸
  - [ ] å¯¦ä¾‹åŒ– PermanentNoteGenerator
  - [ ] èª¿ç”¨ `generate_permanent_note()`
  - [ ] é¡¯ç¤ºçµæœ

- [ ] **3.2.3** æ·»åŠ åƒæ•¸é©—è­‰
  - [ ] é©—è­‰ zettel_ids å­˜åœ¨
  - [ ] é©—è­‰ output è·¯å¾‘æœ‰æ•ˆ
  - [ ] æä¾›å‹å¥½çš„éŒ¯èª¤è¨Šæ¯

**æ–‡ä»¶ä½ç½®**: `kb_manage.py`

**æ¸¬è©¦**:
- [ ] æ¸¬è©¦å‘½ä»¤åŸ·è¡Œ
  ```bash
  python kb_manage.py synthesize-permanent-note \
      --topic "æ¸¬è©¦ä¸»é¡Œ" \
      --zettel-ids CogSci-001 CogSci-002 \
      --output test_note.md
  ```

**é©—æ”¶æ¨™æº–**:
- [ ] å‘½ä»¤å¯æ­£å¸¸åŸ·è¡Œ
- [ ] åƒæ•¸é©—è­‰æ­£ç¢º
- [ ] éŒ¯èª¤è™•ç†å‹å¥½

---

### ä»»å‹™ 3.3: ç«¯åˆ°ç«¯æ¸¬è©¦

**å­ä»»å‹™**:

- [ ] **3.3.1** é¸æ“‡æ¸¬è©¦æ¡ˆä¾‹
  - [ ] æ¡ˆä¾‹ 1ï¼š3 å¼µé«˜åº¦ç›¸é—œå¡ç‰‡
  - [ ] æ¡ˆä¾‹ 2ï¼š5 å¼µä¸­åº¦ç›¸é—œå¡ç‰‡
  - [ ] æ¡ˆä¾‹ 3ï¼šAI notes å’Œ Human notes æ··åˆ

- [ ] **3.3.2** åŸ·è¡Œç”Ÿæˆ
  ```bash
  python kb_manage.py synthesize-permanent-note \
      --topic "è¦–è¦ºæ³¨æ„èˆ‡å·¥ä½œè¨˜æ†¶" \
      --zettel-ids CogSci-001 CogSci-003 CogSci-007 \
      --output permanent_notes/attention_memory.md
  ```

- [ ] **3.3.3** è©•ä¼°è¼¸å‡ºè³ªé‡
  - [ ] å…§å®¹é€£è²«æ€§
  - [ ] ä¾†æºå¼•ç”¨æ­£ç¢º
  - [ ] æ·±åº¦æ€è€ƒæ˜¯å¦é«”ç¾
  - [ ] Markdown æ ¼å¼æ­£ç¢º

**é©—æ”¶æ¨™æº–**:
- [ ] èƒ½æˆåŠŸå¾ 3-5 å¼µå¡ç‰‡ç”Ÿæˆæ°¸ä¹…ç­†è¨˜
- [ ] ä¿ç•™æ‰€æœ‰ä¾†æºå¼•ç”¨
- [ ] å…§å®¹é€£è²«ä¸”æ·±å…¥
- [ ] äººå·¥è©•ä¼°è³ªé‡ > 80%

---

### ä»»å‹™ 3.4: ä½¿ç”¨æ–‡æª”

**å­ä»»å‹™**:

- [ ] **3.4.1** å‰µå»ºä½¿ç”¨æŒ‡å—
  - [ ] æ–‡ä»¶è·¯å¾‘ï¼š`docs/PERMANENT_NOTE_GENERATOR_GUIDE.md`
  - [ ] åŠŸèƒ½ä»‹ç´¹
  - [ ] CLI ä½¿ç”¨æ–¹æ³•
  - [ ] Python API ä½¿ç”¨æ–¹æ³•
  - [ ] ç¯„ä¾‹å ´æ™¯

- [ ] **3.4.2** æ›´æ–° CLAUDE.md
  - [ ] åœ¨ RelationFinder æ”¹é€²æ–¹æ¡ˆå€å¡Šæ·»åŠ æ°¸ä¹…ç­†è¨˜ç« ç¯€
  - [ ] æä¾›ä½¿ç”¨ç¯„ä¾‹

**é©—æ”¶æ¨™æº–**:
- [ ] æ–‡æª”å®Œæ•´æ¸…æ™°
- [ ] ç¯„ä¾‹å¯åŸ·è¡Œ
- [ ] æ¶µè“‹å¸¸è¦‹å•é¡Œ

---

## æ¸¬è©¦èˆ‡é©—è­‰

### å›æ­¸æ¸¬è©¦

**åŸ·è¡Œæ™‚æ©Ÿ**: æ¯å€‹ Phase å®Œæˆå¾Œ

**æ¸¬è©¦æ­¥é©Ÿ**:

- [ ] **æ­¥é©Ÿ 1**: é‹è¡Œæ‰€æœ‰å–®å…ƒæ¸¬è©¦
  ```bash
  pytest tests/test_relation_finder*.py -v
  ```

- [ ] **æ­¥é©Ÿ 2**: é‹è¡Œæ•´åˆæ¸¬è©¦
  ```bash
  python -m pytest tests/integration/test_relation_finder_integration.py
  ```

- [ ] **æ­¥é©Ÿ 3**: åŸ·è¡Œå®Œæ•´çš„é—œä¿‚è­˜åˆ¥
  ```bash
  python kb_manage.py build-concept-network
  ```

- [ ] **æ­¥é©Ÿ 4**: ç”Ÿæˆåˆ†æå ±å‘Š
  ```bash
  python kb_manage.py visualize-network --obsidian \
      --output output/concept_analysis_phase_X
  ```

- [ ] **æ­¥é©Ÿ 5**: æ¯”è¼ƒé—œéµæŒ‡æ¨™
  - [ ] é«˜ä¿¡åº¦é—œä¿‚æ•¸
  - [ ] å¹³å‡ä¿¡åº¦
  - [ ] å»ºè­°é€£çµæ•¸é‡
  - [ ] ç¶²çµ¡å¯†åº¦
  - [ ] è™•ç†æ™‚é–“

**é©—æ”¶æ¨™æº–**:
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] ç„¡å›æ­¸éŒ¯èª¤
- [ ] æ€§èƒ½å¯æ¥å—ï¼ˆ+40%å…§ï¼‰

---

### äººå·¥é©—è­‰

**åŸ·è¡Œæ™‚æ©Ÿ**: Phase 1 å’Œ Phase 2 å®Œæˆå¾Œ

**é©—è­‰æ­¥é©Ÿ**:

- [ ] **æ­¥é©Ÿ 1**: éš¨æ©ŸæŠ½å– 20 æ¢é«˜ä¿¡åº¦é—œä¿‚
  ```python
  import random
  high_conf_relations = [r for r in relations if r.confidence_score >= 0.4]
  sample = random.sample(high_conf_relations, min(20, len(high_conf_relations)))
  ```

- [ ] **æ­¥é©Ÿ 2**: äººå·¥è©•ä¼°æ¯æ¢é—œä¿‚
  - [ ] æŸ¥çœ‹å…©å¼µå¡ç‰‡å…§å®¹
  - [ ] åˆ¤æ–·é—œä¿‚æ˜¯å¦åˆç†ï¼ˆæ˜¯/å¦ï¼‰
  - [ ] è©•ä¼°ä¿¡åº¦è©•åˆ†æ˜¯å¦åˆç†ï¼ˆé«˜/ä¸­/ä½ï¼‰
  - [ ] è¨˜éŒ„å•é¡Œ

- [ ] **æ­¥é©Ÿ 3**: è¨ˆç®—æº–ç¢ºç‡
  ```
  æº–ç¢ºç‡ = åˆç†é—œä¿‚æ•¸ / ç¸½æŠ½æ¨£æ•¸
  ```

- [ ] **æ­¥é©Ÿ 4**: åˆ†æèª¤åˆ¤æ¡ˆä¾‹
  - [ ] æ‰¾å‡ºå…±åŒå•é¡Œ
  - [ ] èª¿æ•´ç®—æ³•åƒæ•¸
  - [ ] é‡æ–°æ¸¬è©¦

**é©—æ”¶æ¨™æº–**:
- [ ] æº–ç¢ºç‡ > 80%
- [ ] ç„¡åš´é‡èª¤åˆ¤
- [ ] å•é¡Œå·²è¨˜éŒ„ä¸¦ä¿®å¾©

---

### æ€§èƒ½æ¸¬è©¦

**åŸ·è¡Œæ™‚æ©Ÿ**: Phase 2 å®Œæˆå¾Œ

**æ¸¬è©¦æ­¥é©Ÿ**:

- [ ] **æ­¥é©Ÿ 1**: è¨˜éŒ„åŸºæº–æ™‚é–“
  ```bash
  time python kb_manage.py build-concept-network
  ```

- [ ] **æ­¥é©Ÿ 2**: è¨˜éŒ„æ”¹é€²å¾Œæ™‚é–“
  ```bash
  time python kb_manage.py build-concept-network
  ```

- [ ] **æ­¥é©Ÿ 3**: è¨ˆç®—å¢é•·ç‡
  ```
  å¢é•·ç‡ = (æ–°æ™‚é–“ - åŸºæº–æ™‚é–“) / åŸºæº–æ™‚é–“
  ```

- [ ] **æ­¥é©Ÿ 4**: è¨˜æ†¶é«”ä½¿ç”¨åˆ†æ
  ```python
  import memory_profiler
  @profile
  def test_relation_finding():
      finder = RelationFinder()
      relations = finder.find_concept_relations()
  ```

**é©—æ”¶æ¨™æº–**:
- [ ] æ™‚é–“å¢é•· < 40%
- [ ] è¨˜æ†¶é«”å¢é•· < 30%
- [ ] ç„¡è¨˜æ†¶é«”æ´©æ¼

---

## æ–‡æª”æ›´æ–°

### ä»£ç¢¼æ–‡æª”

- [ ] **docstring æ›´æ–°**
  - [ ] `_extract_shared_concepts_enhanced()`
  - [ ] `_check_explicit_link_enhanced()`
  - [ ] `_get_domain_similarity()`
  - [ ] `_parse_domain()`
  - [ ] æ‰€æœ‰æ–°å¢å‡½æ•¸

- [ ] **é¡å‹è¨»è§£**
  - [ ] æ‰€æœ‰å‡½æ•¸æ·»åŠ é¡å‹è¨»è§£
  - [ ] ä½¿ç”¨ `typing` æ¨¡çµ„
  - [ ] é€šé mypy æª¢æŸ¥

---

### ä½¿ç”¨æ–‡æª”

- [ ] **RELATION_FINDER_TECHNICAL_DETAILS.md**
  - [x] å·²æ›´æ–°åŸºæº–æ¸¬è©¦çµæœ
  - [x] å·²æ·»åŠ æ”¹é€²æ–¹æ¡ˆæ¦‚è¦½
  - [ ] æ›´æ–°å¯¦ä½œç‹€æ…‹

- [ ] **CLAUDE.md**
  - [x] å·²æ·»åŠ  RelationFinder æ”¹é€²æ–¹æ¡ˆç« ç¯€
  - [ ] æ›´æ–°å¯¦ä½œé€²åº¦
  - [ ] æ·»åŠ ä½¿ç”¨ç¯„ä¾‹

- [ ] **README.md**
  - [ ] æ›´æ–°åŠŸèƒ½åˆ—è¡¨
  - [ ] æ·»åŠ æ”¹é€²äº®é»
  - [ ] æ›´æ–°ç‰ˆæœ¬è™Ÿ

- [ ] **CHANGELOG.md**
  - [ ] è¨˜éŒ„ Phase 1 è®Šæ›´
  - [ ] è¨˜éŒ„ Phase 2 è®Šæ›´
  - [ ] è¨˜éŒ„ Phase 3 è®Šæ›´

---

## å®Œæˆæ¨™æº–

### Phase 1 å®Œæˆæ¨™æº–

- [ ] âœ… æ‰€æœ‰ Phase 1 å­ä»»å‹™å®Œæˆ
- [ ] âœ… å–®å…ƒæ¸¬è©¦é€šéç‡ 100%
- [ ] âœ… å…±åŒæ¦‚å¿µæ•¸é‡å¹³å‡å¢åŠ  50%+
- [ ] âœ… è·¨é ˜åŸŸå¡ç‰‡ä¿¡åº¦æå‡ 20%+
- [ ] âœ… é«˜ä¿¡åº¦é—œä¿‚æ•¸ï¼ˆâ‰¥ 0.4ï¼‰> 0
- [ ] âœ… ä¸ç ´å£ç¾æœ‰åŠŸèƒ½

### Phase 2 å®Œæˆæ¨™æº–

- [ ] âœ… æ‰€æœ‰ Phase 2 å­ä»»å‹™å®Œæˆ
- [ ] âœ… æ•´åˆæ¸¬è©¦é€šé
- [ ] âœ… AI notes å¹³å‡åŒ…å« 2-3 å€‹é€£çµ
- [ ] âœ… é€£çµèªå¢ƒè­˜åˆ¥æº–ç¢ºç‡ > 80%
- [ ] âœ… æ˜ç¢ºé€£çµè¦†è“‹ç‡ > 30%
- [ ] âœ… Obsidian å»ºè­°é€£çµåŠŸèƒ½å¯ç”¨
- [ ] âœ… äººå·¥é©—è­‰æº–ç¢ºç‡ > 80%

### Phase 3 å®Œæˆæ¨™æº–

- [ ] âœ… æ‰€æœ‰ Phase 3 å­ä»»å‹™å®Œæˆ
- [ ] âœ… ç«¯åˆ°ç«¯æ¸¬è©¦é€šé
- [ ] âœ… èƒ½å¾ 3-5 å¼µå¡ç‰‡ç”Ÿæˆæ°¸ä¹…ç­†è¨˜
- [ ] âœ… ä¿ç•™ä¾†æºå¼•ç”¨
- [ ] âœ… å…§å®¹é€£è²«ä¸”æ·±å…¥
- [ ] âœ… CLI å‘½ä»¤å¯ç”¨
- [ ] âœ… ä½¿ç”¨æ–‡æª”å®Œæ•´

### æ•´é«”å®Œæˆæ¨™æº–

- [ ] âœ… æ‰€æœ‰ Phase å®Œæˆ
- [ ] âœ… é«˜ä¿¡åº¦é—œä¿‚æ•¸ï¼ˆâ‰¥ 0.4ï¼‰> 5,000
- [ ] âœ… å¹³å‡ä¿¡åº¦è©•åˆ† > 0.50
- [ ] âœ… å»ºè­°é€£çµå¯ç”¨æ€§ 100%
- [ ] âœ… æ˜ç¢ºé€£çµè¦†è“‹ç‡ > 50%
- [ ] âœ… å›æ­¸æ¸¬è©¦é€šé
- [ ] âœ… æ€§èƒ½å¯æ¥å—ï¼ˆ+40%å…§ï¼‰
- [ ] âœ… æ‰€æœ‰æ–‡æª”å·²æ›´æ–°
- [ ] âœ… ä»£ç¢¼å·² code review
- [ ] âœ… æº–å‚™åˆä½µåˆ° main

---

## é™„éŒ„ï¼šå¿«é€Ÿåƒè€ƒ

### é—œéµæ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾‘ |
|------|------|
| RelationFinder æ ¸å¿ƒ | `src/analyzers/relation_finder.py` |
| PermanentNoteGenerator | `src/analyzers/permanent_note_generator.py` |
| Zettelkasten Prompt | `templates/prompts/zettelkasten_template.jinja2` |
| é…ç½®æ–‡ä»¶ | `config/settings.yaml` |
| å–®å…ƒæ¸¬è©¦ | `tests/test_relation_finder*.py` |
| KB Manager CLI | `kb_manage.py` |

### é—œéµå‘½ä»¤

```bash
# å–®å…ƒæ¸¬è©¦
pytest tests/test_relation_finder*.py -v

# æ•´åˆæ¸¬è©¦
pytest tests/integration/test_relation_finder_integration.py

# é—œä¿‚è­˜åˆ¥
python kb_manage.py build-concept-network

# ç”Ÿæˆåˆ†æå ±å‘Š
python kb_manage.py visualize-network --obsidian --output output/concept_analysis_v2

# æ°¸ä¹…ç­†è¨˜ç”Ÿæˆ
python kb_manage.py synthesize-permanent-note \
    --topic "ä¸»é¡Œ" \
    --zettel-ids id1 id2 id3 \
    --output note.md
```

### é—œéµæŒ‡æ¨™ç›®æ¨™

| æŒ‡æ¨™ | åŸºæº– | Phase 1 ç›®æ¨™ | Phase 2 ç›®æ¨™ | Phase 3 ç›®æ¨™ |
|------|------|-------------|-------------|-------------|
| é«˜ä¿¡åº¦é—œä¿‚æ•¸ï¼ˆâ‰¥ 0.4ï¼‰ | 0 | 1,000+ | 5,000+ | 5,000+ |
| å¹³å‡ä¿¡åº¦ | 0.33 | 0.40+ | 0.50+ | 0.50+ |
| æ˜ç¢ºé€£çµè¦†è“‹ç‡ | 11.6% | 15%+ | 30%+ | 50%+ |
| å»ºè­°é€£çµå¯ç”¨æ€§ | 0% | å¯ç”¨ | å®Œå…¨å¯ç”¨ | å®Œå…¨å¯ç”¨ |

---

**æ–‡ä»¶ç‹€æ…‹**: âœ… æª¢æŸ¥æ¸…å–®å®Œæˆ
**ä¸‹ä¸€æ­¥**: é–‹å§‹ Phase 1 å¯¦ä½œ
